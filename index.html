<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="author" content="Alex Resiga">
  <title>fstvlr</title>
  <link rel="stylesheet" type="text/css" href="main.css">
  <script src="https://sdk.accountkit.com/en_US/sdk.js"></script>
</head>
<body>
  <script>
    window.fbAsyncInit = function() {
      FB.init({
        appId      : '338340539949022',
        xfbml      : true,
        version    : 'v2.10'
      });
      FB.AppEvents.logPageView();
    };

    (function(d, s, id){
       var js, fjs = d.getElementsByTagName(s)[0];
       if (d.getElementById(id)) {return;}
       js = d.createElement(s); js.id = id;
       js.src = "//connect.facebook.net/en_US/sdk.js";
       fjs.parentNode.insertBefore(js, fjs);
     }(document, 'script', 'facebook-jssdk'));
  </script>
  <script>
    // initialize Account Kit with CSRF protection
    $(".message").append("<p>initialized Account Kit.</p>");
    AccountKit_OnInteractive = function(){
      AccountKit.init(
        {
          appId:"338340539949022",
          state:"qwertyuiopasdfghjkl"
          version:"v1.1",
          fbAppEventsEnabled:true,
          Redirect:"https://alexresiga.github.io/fstvlr/login_success.php"
        }
      );
    };

    // login callback
    function loginCallback(response) {
      if (response.status === "PARTIALLY_AUTHENTICATED") {
        var code = response.code;
        var csrf = response.state;
        // Send code to server to exchange for access token
      }
      else if (response.status === "NOT_AUTHENTICATED") {
        // handle authentication failure
      }
      else if (response.status === "BAD_PARAMS") {
        // handle bad parameters
      }
    }

    // phone form submission handler
    function smsLogin() {
      var countryCode = document.getElementById("country_code").value;
      var phoneNumber = document.getElementById("phone_number").value;
      AccountKit.login(
        'PHONE',
        {countryCode: countryCode, phoneNumber: phoneNumber}, // will use default values if not specified
        loginCallback
      );
    }


    // email form submission handler
    function emailLogin() {
      var emailAddress = document.getElementById("email").value;
      AccountKit.login(
        'EMAIL',
        {emailAddress: emailAddress},
        loginCallback
      );
    }
  </script>
  <div class="fb-like" data-share="true" data-width="740" data-show-faces="true"></div>

  <input value="+4" id="country_code" />
<input placeholder="phone number" id="phone_number"/>
<button onclick="smsLogin();">Login via SMS</button>
<div>OR</div>
<input placeholder="email" id="email"/>
<button onclick="emailLogin();">Login via Email</button>

<div class="message">
                    <p><center><b>Message Board</b></center></p>
                </div>
            </center>
        </div>

<form id="login_success" method="post" action="/login_success.php">
  <input id="csrf" type="hidden" name="csrf" />
  <input id="code" type="hidden" name="code" />
</form>

<script>
  function loginCallback(response) {
    if (response.status === "PARTIALLY_AUTHENTICATED") {
      document.getElementById("code").value = response.code;
      document.getElementById("csrf").value = response.state;
      document.getElementById("login_success").submit();
    }
  }
</script>
</body>
</html>
